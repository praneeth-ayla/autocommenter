# AutoCommenter

autocommenter is a command-line tool for Go projects that leverages AI to automate documentation tasks. It scans your codebase to build a contextual understanding of each file's purpose, exports, and imports. This context is then used by an AI provider to generate code comments and comprehensive `README.md` files.

The tool identifies the project root by searching for a `go.mod` file and performs all operations from there.

## Project Structure

The project is organized into a command-line interface and several internal packages that handle AI interaction, project scanning, and configuration management.

```text
.
├── cmd/
│   ├── comments.go
│   ├── context.go
│   ├── provider.go
│   ├── readme.go
│   └── root.go
├── internal/
│   ├── ai/
│   ├── config/
│   ├── contextstore/
│   ├── prompt/
│   ├── scanner/
│   └── ui/
├── go.mod
├── main.go
└── LICENSE
```

## Installation

Install autocommenter using `go install`:

```bash
go install github.com/praneeth-ayla/autocommenter@latest
```

Ensure that your Go environment is set up correctly and that `$GOPATH/bin` is in your system's `PATH`.

## Configuration

Before using the tool, you must configure your AI provider and API key.

### 1. AI Provider

You can set the AI provider using the interactive `provider set` command. The tool saves your choice to a configuration file. Currently, `gemini` is the only supported provider. If no provider is configured, it defaults to "gemini".

To set the provider:

```bash
autocommenter provider set
```

This will launch an interactive prompt to select from available providers.

To check your currently configured provider, run:

```bash
autocommenter provider get
```

### 2. API Key

autocommenter requires a Gemini API key. You must set it as an environment variable. The application will check for either `GOOGLE_API_KEY` or `GEMINI_API_KEY`.

```bash
export GEMINI_API_KEY="YOUR_API_KEY"
# or
export GOOGLE_API_KEY="YOUR_API_KEY"
```

## Usage

The primary workflow involves two main steps: first, generating the project context, and second, using that context to generate documentation. All AI API calls include built-in retry logic to handle rate-limiting.

### Step 1: Generate Project Context

Scan your project to build the context that the AI will use for all documentation tasks. This command analyzes your `.go` files in batches, generates summaries for each, and stores this metadata locally for subsequent commands.

```bash
autocommenter context gen
```

### Step 2: Generate Documentation

Once the context has been generated, you can create code comments or a `README.md` file.

#### Generate Code Comments

To add comments to your Go files, run the `comments gen` command. You will be prompted to select a comment style from a list of options. The tool will then generate comments and write the updated content back to the files.

This command includes a safety mechanism: if the AI alters any non-comment code, it will attempt up to two "fix" passes to apply the comments safely while preserving the original code logic.

```bash
autocommenter comments gen
```

Available comment styles include:

- `minimalist`
- `explanatory`
- `detailed`
- `docstring`
- `inline-only`

#### Generate README.md

To generate a `README.md` for your project, use the `readme gen` command. It uses the project's file tree and code context to create a comprehensive document. If a `README.md` already exists, its content will be provided to the AI for context when generating the new version.

```bash
autocommenter readme gen
```

By default, this creates or updates `README.md` in the project root. You can specify a different output path using the `--path` flag.

```bash
autocommenter readme gen --path ./docs/README.md
```

## Commands

Here is a summary of the available commands:

| Command                      | Description                                     |
| ---------------------------- | ----------------------------------------------- |
| `autocommenter provider set` | Interactively sets the AI provider.             |
| `autocommenter provider get` | Displays the currently configured AI provider.  |
| `autocommenter context gen`  | Scans the project and generates context data.   |
| `autocommenter comments gen` | Generates and adds comments to Go source files. |
| `autocommenter readme gen`   | Generates a `README.md` file for the project.   |

---

_This README was automatically generated by [autocommenter](https://github.com/praneeth-ayla/autocommenter)_
